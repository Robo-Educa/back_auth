<div align="center">
<img src="static/images/logo.png" alt="Logo">
</div>

<hr>

[English Version](/README.md)

![Portuguese](https://img.shields.io/badge/Language-English-blue)
<hr>


## ü§ì Aprenda a programar construindo seu pr√≥prio rob√¥.

Rob√¥ Educa  √© uma plataforma inovadora que ensina programa√ß√£o para crian√ßas de 6 a 14 anos, promovendo a inclus√£o e a sustentabilidade ü§ù‚ôªÔ∏è. A jornada come√ßa com uma hist√≥ria inspiradora de dois irm√£os, Suzy e Ot√°vio, que desejam construir um rob√¥ ü§ñ e contam com a ajuda de seu professor Carlos Sales üë®‚Äçüè´ que os incentiva a montar seu pr√≥prio rob√¥ humanoide utilizando materiais reciclados, programa√ß√£o e nuvem ‚ôªÔ∏èüíª‚òÅÔ∏è.

√â neste contexto que surge o Web Aplicativo Rob√¥ Educa que acess√≠vel a partir de qualquer smartphone üì± se torna o "c√©rebro" do rob√¥ üß† interagindo com a crian√ßa atrav√©s de  mensagens de √°udio üó£Ô∏è tornando-o acess√≠vel inclusive para pessoas com defici√™ncia visual. A montagem do rob√¥ e a intera√ß√£o com o aplicativo estimulam a coordena√ß√£o motora üñêÔ∏è e a criatividade ‚ú® ensinando a crian√ßa conceitos tecnol√≥gicos de forma l√∫dica e inclusiva.

E toda a m√°gica realizado pelo aplicativo s√≥ √© poss√≠vel por conta do uso da **Google GEMINI API** ü§ñ que permite ao Rob√¥ Educa entender e responder √†s perguntas da crian√ßa, explicar conceitos complexos ü§Ø e realizar quizzes gamificados üéâ. Essa tecnologia dispon√≠vel na nuvem da Google transforma o aprendizado em uma conversa natural e divertida üòÑ abrindo novas perspectivas para o futuro destas crian√ßas üöÄ.

## ü§ñ Como testar o aplicativo:
* Acesse : https://robo-educa-gemini-server-xd3gd6y2aa-uw.a.run.app/
* Clique em Iniciar;
* Autorize o uso do Microfone;
* Clique em: ENTRAR COMO VISITANTE;
* Ou√ßa as perguntas e responda corretamente para acumular pontos.

## üìÜ Hist√≥rico

<div align="center">
<img src="static/images/robopet.jpg" alt="Logo">
</div>

A Intelig√™ncia artificial est√° cada vez mais presente em nossas vidas, fazendo-se necess√°rio estimular o maior n√∫mero de pessoas a darem os primeiros passos no entendimento desta tecnologia permitindo assim que as mesmas se tornem n√£o somente usu√°rios mais principalmente protagonistas na cria√ß√£o dos novos recursos desta tecnologia no futuro.

Foi a partir deste pensamento que no ano de 2018 surgiu o projeto Rob√¥ Educa. Uma plataforma inclusiva para Ensino de Programa√ß√£o em que a crian√ßa d√° os primeiros passos neste universo montando o seu pr√≥prio rob√¥. Nesta √©poca o rob√¥ era feito de garrafas PET e alguns componentes eletr√¥nicos como Arduino, leds, resistores, e baterias.

Mas foi somente no ano de 2024 com o advento das IA Generativas e da **Google GEMINI API**, que o rob√¥ passou a ter um "c√©rebro" capaz de responder de forma **inteligente e r√°pida**, tornando a intera√ß√£o com a crian√ßa **fl√∫ida e encantadora** üòÑ!

O idealizador deste projeto, [Carlos Sales](https://drive.google.com/file/d/1KPPJQhNn_YsWYK6qllP6muns6WlSRyM1/view?usp=sharing), √© um homem negro de origem perif√©rica graduado em Ci√™ncia de Dados e Desenvolvedor de Sistemas. O mesmo conta um pouco da sua hist√≥ria no document√°rio [C0d3rs Championship](https://www.primevideo.com/detail/0GS98CG03BVM7C224YK7KIWXOJ) dispon√≠vel no Amazon Prime Video. 

<div style="display: flex;">
<img src="static/images/image1.jpg" alt="Imagem 1" style="width: 22%; margin-right: 8px;">
<img src="static/images/image2.jpg" alt="Imagem 2" style="width: 22%; margin-right: 8px;">
<img src="static/images/image3.jpg" alt="Imagem 3" style="width: 22%; margin-right: 8px;">
<img src="static/images/image4.jpg" alt="Imagem 4" style="width: 22%;">
</div>

## üí™ Impacto

Utilizando apenas alguns poucos leds, resistores e baterias, conseguimos impactar centenas de crian√ßas em diversas comunidades da nossa cidade. 

J√° a partir do uso da intelig√™ncia artificial generativa e da nuvem, surgem novas possibilidades de expans√£o das habilidades cognitivas de nosso rob√¥. Com a qual esperamos  alcan√ßar um n√∫mero ainda maior de crian√ßas, agora **em todo o mundo**!

Visite nossa [galeria de fotos](https://photos.app.goo.gl/yJiewdTTsNFtmF846) para conhecer mais sobre nossas oficinas de inclus√£o realizadas em comunidades carentes na cidade de Salvador, Bahia - Brasil.

üí™ E voc√™? Gostou? Ent√£o fa√ßa sua parte e colabore com esta iniciativa para que possamos ampliar ainda mais o nosso impacto.

## üíª Tecnologias utilizadas neste aplicativo

<div align="center">
<img src="static/images/gemini.png" alt="Logo Gemini API">
</div>

- ![Pyton](https://img.shields.io/badge/python-v3-green)
- ![HTML](https://img.shields.io/badge/HTML-5-orange)
- ![JavaScript](https://img.shields.io/badge/JavaScript-ES6-yellow)
- ![Firestore](https://img.shields.io/badge/Firebase-Firestore-orange?style=for-the-badge&logo=firebase)
- ![Google Cloud](https://img.shields.io/badge/Google_Cloud-gray?style=for-the-badge&logo=google-cloud)

## Vis√£o Geral da Plataforma Rob√¥ Educa

A plataforma **Rob√¥ Educa** oferece uma experi√™ncia pr√°tica e criativa para os alunos, orientando-os na montagem f√≠sica de um rob√¥ humanoide. Este rob√¥ √© feito com materiais recicl√°veis ou MDF e pode ser customizado com elementos como LEDs, baterias e outros componentes. Ap√≥s a montagem f√≠sica, os alunos d√£o vida ao rob√¥ usando o "c√©rebro" dele, que √© o aplicativo descrito neste c√≥digo.

O aplicativo permite que o rob√¥ humanoide desempenhe fun√ß√µes cognitivas: ouvir, pensar e falar. Essas capacidades s√£o implementadas utilizando tecnologias de **Speech-to-Text** e **Text-to-Speech**, permitindo que o rob√¥ ou√ßa mensagens faladas, as analise e responda com uma fala sintetizada.

### Pilha Tecnol√≥gica e Arquitetura

A aplica√ß√£o √© desenvolvida utilizando ferramentas open-source e hospedada na Google Cloud, aproveitando sua infraestrutura robusta. O backend √© desenvolvido em Python usando o framework Flask, seguindo o padr√£o de design **Service/Repository**:

- **Camada de Servi√ßo**: Lida com a l√≥gica de neg√≥cio.
- **Camada de Reposit√≥rio**: Gerencia a integra√ß√£o com o banco de dados.

Para armazenamento de dados, a plataforma utiliza um banco de dados NoSQL, o **Firebase/Firestore**, que oferece escalabilidade e flexibilidade para armazenar conversas e dados de usu√°rios.

### Arquivos Principais e Funcionalidades

### Backend - `routes.py`
O arquivo `routes.py` gerencia todas as rotas dispon√≠veis na aplica√ß√£o. √â aqui que diferentes endpoints s√£o definidos para lidar com as intera√ß√µes dos usu√°rios e o processamento de dados.

```python
# Depend√™ncias
from main import app
from flask import render_template, request, session, redirect, url_for, make_response, jsonify
# Servi√ßos
import service.loginService as loginService
import service.talkService as talkService

# P√°gina inicial/Index
@app.route('/')
def home():
    return render_template('index.html')
```

### Frontend - HTML, CSS e JavaScript
O frontend √© implementado utilizando HTML, CSS e JavaScript, focando na simplicidade e facilidade de uso. Ele come√ßa solicitando o acesso ao microfone, que √© gerenciado pelo `mediadevices.js`.

**Acesso ao Microfone**:
Quando o aplicativo √© iniciado, ele verifica as permiss√µes para uso do microfone. Se for a primeira vez que o usu√°rio acessa o app, ele ser√° solicitado a conceder a permiss√£o. Este processo √© gerenciado pelo arquivo `mediadevices.js`.

```javascript
async function devices_micPrompt() {
    let permission;
    await navigator.mediaDevices
        .getUserMedia({
            audio: true
        })
        .then(function (stream) {
            permission = "granted"        
        })
        .catch(function (error) {
            if (error.message == "Requested device not found") {
                permission = "notFound";
            } else if (error.message == "Permission denied") {
                permission = "denied";
            } else {
                console.log(error.message)
                permission = 'error';
            }
        });
    return permission;
}
```

**Autentica√ß√£o do Usu√°rio**:
O processo de login √© gerenciado pelo `login.js`, que envia uma requisi√ß√£o POST para o backend para validar o usu√°rio. Se o usu√°rio n√£o tiver credenciais v√°lidas, ele pode fazer login como convidado.

```javascript
async function login(usertype) {    

    let username = document.getElementById('username').value;
    let password = document.getElementById('password').value;    

    displayStartLogin();
    
    await fetch('/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ username: username, password: password, usertype: usertype })
    })
    .then(response => response.json())
    .then(data => {

        displayStopLogin();
        
        switch (data.status) {
            case 'success':
                goToPage("interaction");
                break;
            case 'errorUser':
                alert("Usu√°rio inexistente");
                document.getElementById("username").focus();
                break;
            case 'errorPwd':
                alert("Senha incorreta");
                document.getElementById("password").focus();
                break;
            case 'errorGuest':
                alert("N√£o foi poss√≠vel criar usu√°rio tempor√°rio. Tente novamente!");                
                break;                
            default:
                break;
        }        
    });
    
}
```

**Intera√ß√£o**:
Ap√≥s o login bem-sucedido, a intera√ß√£o come√ßa no frontend com o arquivo `interaction.html`. A interface visual, gerenciada pelo `display.js`, √© simples, com elementos que simbolizam escuta, pensamento e fala.

**Escuta Cont√≠nua e Processamento de Fala**:
O rob√¥ come√ßa com uma sauda√ß√£o e convida o usu√°rio a participar de um quiz sobre programa√ß√£o. Ap√≥s falar, o app ativa o microfone em modo cont√≠nuo, escutando o que o usu√°rio fala. Essas tarefas s√£o realizadas pelo `Talk.js`, que utiliza as APIs `Media Devices`, `SpeechRecognition()` e `SpeechSynthesisUtterance()`.

```javascript
// Este evento √© acionado quando o reconhecimento de voz captura um resultado
recognition.onresult = event => {    
    const transcript = event.results[event.resultIndex][0].transcript;    
    talk(transcript);           // Envia transcri√ß√£o do audio falado pelo usu√°rio para o backend processar junto √† Intelig√™ncia Artificial e dar uma respectiva resposta
};

// Verifica se usu√°rio n√£o estiver falando (reproduzindo audio). Ap√≥s 1 minuto de inatividade, interrrompe reconhecimento e exibe bot√£o de pausa
recognition.onend = () => {
    if (speakStatus == false) {     
        timestampAtual = Date.now();
        var diferenca = timestampAtual - timestampParam;
        var minutosPassados = diferenca / (1000 * 60);
        if (minutosPassados < 1) {
            recognition.start(); // Inicia o reconhecimento de voz
        } else {
            hideAllExceptClose();
            showElement("divPauseStart");
        }
    }        
};
```

### Processamento Cognitivo com a API Google Gemini

Quando uma frase completa √© detectada, ela √© enviada para o backend para processamento cognitivo. Isso √© realizado utilizando a **API GEMINI**, que aproveita o modelo `gemini-1.5-flash` para respostas r√°pidas e precisas, garantindo conversas fluidas que tornam o rob√¥ mais envolvente e realista.

```python
import google.generativeai as genai

# Intera√ß√£o com a Google Gemini API
def talk(userMessage):
    # Obtem ID do usu√°rio logado
    user_id = session["userId"]

    # Obtem hist√≥rico de mensagens do usu√°rio
    message_history = messageHistory.getById(user_id)
    message_history_gemini_format = format_messages_for_gemini(message_history)   
    
    # Salva mensagem do usu√°rio em banco de dados
    role = "user"                                       # role=user => mensagem enviada pelo usu√°rio
    messageHistory.store(user_id, role, userMessage)    

    # Inicia intera√ß√£o com Gemini AI
    try:
        convo = model.start_chat(history = message_history_gemini_format) # Inicia chat, contextualizando a IA com o hist√≥rico da conversa√ß√£o
        convo.send_message(userMessage)                     # envia nova mensagem para ser processada pela IA
        bot_response = convo.last.text                      # Obtem resposta da IA
    except:
        bot_response = "error"

    # Salva resposta do Bot em banco de dados
    if bot_response != "error":
        role = "model"                                      # role=model => mensagem enviada pela IA
        messageHistory.store(user_id, role, bot_response)    
    else:
        bot_response = "Desculpe, n√£o foi poss√≠vel obter resposta da Intelig√™ncia Artificial."

    response = {"status": "success", "message": bot_response}
    return response
```

### Armazenamento de Dados e Personaliza√ß√£o

A plataforma armazena a conversa de cada usu√°rio no Firestore utilizando cole√ß√µes NoSQL. Isso garante a seguran√ßa das crian√ßas, al√©m de permitir a modera√ß√£o e personaliza√ß√£o do conte√∫do.

```python
import time
import repository.db_resource as dbr

# Inst√¢ncia de conex√£o com banco de dados NoSQL Google Firestore
db = dbr.firestore_resource()       

# Obtem hist√≥rico de mensagens a partir do ID do usu√°rio
def getById(user_id):
    collection = f"message_history_{user_id}"
    messages_ref = db.collection(collection).order_by("timestamp")
    messages = messages_ref.stream()

    return messages

# Salva mensagem para recupera√ß√£o de hist√≥rico de conversa na contextualiza√ß√£o da resposta
def store(user_id, role, message):
    collection = f"message_history_{user_id}"
    try:
        doc_ref = db.collection(collection).document()
        doc_ref.set({
            "timestamp": int(time.time()),
            "role": role,
            "parts": [message]
        })    
    except Exception as e:
        print(f"Erro ao salvar mensagem no banco de dados. Detalhes: {e}")
        return False
```

### Conclus√£o

O Rob√¥ Educa combina criatividade f√≠sica com intelig√™ncia artificial de ponta para criar uma experi√™ncia interativa e educacional para crian√ßas. A arquitetura modular da plataforma e o uso de tecnologias web modernas a tornam escal√°vel, segura e adapt√°vel a diversos ambientes de aprendizado.

## ‚úçÔ∏è Como executar este aplicativo em seu PC Windows

1. Clone o reposit√≥rio:
```
$ git clone https://github.com/Robo-Educa/robo-educa-gemini-server.git 
```
2. Instale as depend√™ncias:
```
$ cd robo-educa-gemini-server
$ pip install -r requirements.txt
```
3. Crie um arquivo .ENV a partir do .ENV.EXAMPLE e preencha os valores das vari√°veis de ambiente conforme o seu projeto.

4. Execute o projeto:
```
$ python main.py
```
5. Teste no Navegador:
```
http://localhost:5000
```
## ‚òÅÔ∏è Como realizar deploy no ambiente de nuvem da Google (Cloud Run)
![Google Cloud](https://img.shields.io/badge/Google_Cloud-gray?style=for-the-badge&logo=google-cloud)
* No console da Google Cloud Platform, crie um Projeto 
* Certifique-se de ter instalado em seu PC Windows a CLI gcloud (Google Cloud SDK Shell)
* Em um terminal do Google Cloud SDK Shell, v√° para a pasta em que se encontra o seu projeto e inicialize sua conex√£o informando o seu email, projeto e regi√£o default para hospedagem do seu App:
```
$ cd\[path do projeto]
$ gcloud init
```
* Fa√ßa o deploy do seu App:
```
$ gcloud run deploy --source .
```
* No console da Google Cloud Platform, selecione o seu projeto.
* No menu de navega√ß√£o selecione: FireBase-Firestore 
* Crie um Banco de Dados do tipo Nativo
* Baixe um arquivo JSON contendo credenciais de acesso ao seu banco:
    * IAM e Administrador / Contas de Servi√ßo / Clicar na conta de Servi√ßo: **Default compute service account**
    * Chaves / Adicionar chave / Criar nova Chave / JSON / Criar
    * O arquivo JSON ser√° baixado automaticamente
* No menu de navega√ß√£o selecione: Google Cloud Storage
* Crie um Bucket privado. Salve neste Bucket o arquivo JSON contendo credencial de acesso ao banco de dados
* No menu de navega√ß√£o selecione: Cloud Run 
* Clique no Aplicativo 
* Clique em: "Editar e implantar uma nova vers√£o"
    * Clique em Volumes / Adicionar um Volume referente ao Bucket contendo a credencial do banco de dados
        * Tipo: Bucket do Cloud Storage
        * Acessar a Guia Containers / Montagem de Volumes / Montar Volume
        * Selecionar o nome do volume criado 
        * Caminho da Montagem : especificar um nome que servir√° como path. Ex: /config
        * Concluir / Implantar
* Clique novamente em: Editar e implantar uma nova vers√£o    
    * Vari√°veis e Secrets / Adicione as mesmas vari√°veis contidas n arquivo .ENV.example
        * Aten√ß√£o para vari√°vel PATH_CREDENTIAL_FIRESTORE que dever√° conter o path do volume rec√©m criado. Ex: /config/credencial.json
        * Aten√ß√£o para vari√°vel API_KEY que dever√° conter uma chave v√°lida que pode ser obtida em : https://aistudio.google.com
* Aten√ß√£o: Cuidado com o arquivo JSON contendo a credencial de acesso ao banco de dados e tamb√©m com sua API_KEY Gemini. Nunca os exponha publicamente, utilize secrets ou outros recusos de seguran√ßas recomendados pela plataforma Google Cloud.

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a [Apache 2.0 License](LICENSE). Observe tamb√©m os Termos de Servi√ßo.

## ü§ù Contribui√ß√µes

Contribui√ß√µes s√£o bem-vindas! Sinta-se √† vontade para abrir um pull request ou colaborar de qualquer outra forma.

* Contatos/WhatsApp: +55 (71) 9.9341-6896 
* E-mail: roboeduca.net@gmail.com

<div style="display: flex;">
<img src="static/images/ods1.jpg" alt="Ods 4" style="width: 30%; margin-right: 5px;">
<img src="static/images/ods2.jpg" alt="ODS ONU" style="width: 30%; margin-right: 5px;">
<img src="static/images/ods3.jpg" alt="Ods 10" style="width: 30%;">
</div>